
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, '.All Subjects', 'All Subjects');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Administraitve', 'Administrative');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Agricultural Development', 'Agriculture');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Agricultural Land', 'Agriculture');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Fertilizer Application', 'Agriculture');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Fertilizers', 'Agriculture');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Horticulture', 'Agriculture');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Agro-Ecology', 'Agriculture');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Agro-ecology', 'Agriculture');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Animal Population', 'Animals');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Cattle', 'Livestock');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Chad Lake', 'Chad Basin');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Cropping Systems', 'Crops');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Growth Period', 'Crops');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Agroclimatic zones', 'Agroclimatic Zones');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Awash River basin', 'Awash River Basin');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'C limate', 'Climate');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Climatic Zones', 'Climate');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Climatology', 'Climate');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Disease transmission', 'Disease Transmission');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Ecology. LGP', 'Ecology');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Ecologgy', 'Ecology');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'EU', 'European Union');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Fisheries', 'Fishery');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Fishery. Fishery Resources', 'Fishery');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Fuelwood', 'Forest Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Timber Trees', 'Forest Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Grassland Management', 'Grasslands');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Geology. Land Resources', 'Geology');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Irrigated Land', 'Irrigation');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Irrigated Farming', 'Irrigation');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'land', 'Land');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Land Resource', 'Land Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Land resources', 'Land Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Land Resoures', 'Land Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Land suitability', 'Land Suitability');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Land Suitability - Topography', 'Land Suitability');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'land use', 'Land Use');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Land use', 'Land Use');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Land Use Planning', 'Land Use');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Lan Use', 'Land Use');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Land Economics', 'Land Management');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Land Improvement', 'Land Management');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Land ownership', 'Land Management');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Mediterraean Region', 'Mediterranean Region');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Mekong River', 'Mekong River Basin');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Mekong Basin', 'Mekong River Basin');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Merim Lagoon', 'Merim Lagoon Basin');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Merim Lagoon basin', 'Merim Lagoon Basin');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Nile', 'Nile River Basin');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Ocean/Sea', 'Oceanology');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Physiographic Features', 'Physiography');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Phsiography', 'Physiography');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Population density', 'Population');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Population Density', 'Population');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Rufiji basin', 'Rufiji Basin');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Rural settlement', 'Rural Settlement');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Tropical Africa', 'Tropical Zones');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Topogaphy', 'Topography');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Topography. Hypsometry', 'Topography');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Topography. Tourism', 'Topography');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Topograqphy', 'Topography');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Topogreaphy', 'Topography');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Altitude', 'Topography');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Water Management', 'Water Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Water Reservoirs', 'Water Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Water Resouces', 'Water Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Water Resource', 'Water Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Water Resources. Groundwater', 'Water Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Watershed Management', 'Water Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Water Use', 'Water Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Dams', 'Water Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Hydrology. Water Resources', 'Water Resources');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Volta', 'Volta River Basin');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Volta River', 'Volta River Basin');

UPDATE xml2db.mapset SET keyword_theme = (
    SELECT array_agg(elem)
    FROM unnest(keyword_theme) AS x
    CROSS JOIN LATERAL 
       (SELECT unnest(ARRAY['Hydrography', 'Water Resources']) AS elem
        WHERE x = 'Hydrography and Water Resources'
        UNION ALL
        SELECT x AS elem
        WHERE x != 'Hydrography and Water Resources') sub
) WHERE 'Hydrography and Water Resources' = ANY(keyword_theme);

UPDATE xml2db.mapset SET keyword_theme = (
    SELECT array_agg(elem)
    FROM unnest(keyword_theme) AS x
    CROSS JOIN LATERAL 
       (SELECT unnest(ARRAY['Ecology', 'Cultivated Land']) AS elem
        WHERE x = 'Ecology. Cultivated Land'
        UNION ALL
        SELECT x AS elem
        WHERE x != 'Ecology. Cultivated Land') sub
) WHERE 'Ecology. Cultivated Land' = ANY(keyword_theme);

UPDATE xml2db.mapset SET keyword_theme = (
    SELECT array_agg(elem)
    FROM unnest(keyword_theme) AS x
    CROSS JOIN LATERAL 
       (SELECT unnest(ARRAY['Ecology', 'Farmland']) AS elem
        WHERE x = 'Ecology. Farmland'
        UNION ALL
        SELECT x AS elem
        WHERE x != 'Ecology. Farmland') sub
) WHERE 'Ecology. Farmland' = ANY(keyword_theme);

UPDATE xml2db.mapset SET keyword_theme = (
    SELECT array_agg(elem)
    FROM unnest(keyword_theme) AS x
    CROSS JOIN LATERAL 
       (SELECT unnest(ARRAY['Erosion', 'Climate']) AS elem
        WHERE x = 'Erosion. Climate'
        UNION ALL
        SELECT x AS elem
        WHERE x != 'Erosion. Climate') sub
) WHERE 'Erosion. Climate' = ANY(keyword_theme);

UPDATE xml2db.mapset SET keyword_theme = (
    SELECT array_agg(elem)
    FROM unnest(keyword_theme) AS x
    CROSS JOIN LATERAL 
       (SELECT unnest(ARRAY['Forestry', 'Vegetation']) AS elem
        WHERE x = 'Forestry and Vegetation'
        UNION ALL
        SELECT x AS elem
        WHERE x != 'Forestry and Vegetation') sub
) WHERE 'Forestry and Vegetation' = ANY(keyword_theme);

UPDATE xml2db.mapset SET keyword_theme = (
    SELECT array_agg(elem)
    FROM unnest(keyword_theme) AS x
    CROSS JOIN LATERAL 
       (SELECT unnest(ARRAY['Hydrography', 'Water Resources']) AS elem
        WHERE x = 'Hydrography and Water Resources'
        UNION ALL
        SELECT x AS elem
        WHERE x != 'Hydrography and Water Resources') sub
) WHERE 'Hydrography and Water Resources' = ANY(keyword_theme);

UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Permafrost areas', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Lithology', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Water Resources. Soil Types', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Water Holding Capacity', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Ecological Soil Types', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Anthropogenic Soils', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'soil', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Association', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Classification', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Chemicophysical Properties', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Chemistry', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Conservation', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Constraints', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Degradation', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil deterioration', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Deterioration', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Fertility', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Management', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Map', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Morphological Features', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Morphological Features. Geology', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Parent Materials', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Pollution', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Reclamation', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soils', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Sequences', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Texture', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Type', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'soil types', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil types', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soi l Types', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Types', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Types.', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil; Types', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Types; Geology', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Types Land Suitability', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Types. Land Suitability', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Types. Land Use', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Types. Rural Settlement', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Types; Sugar Cane', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Soil Water Content', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Dsoil Types', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Calcareous Soils', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Glacial Soils', 'Soil');
UPDATE xml2db.mapset SET keyword_theme = array_replace(keyword_theme, 'Sedimentation', 'Soil');
-- removed repeated
UPDATE xml2db.mapset SET keyword_theme = (SELECT array_agg(DISTINCT unnested_value) FROM unnest(keyword_theme) AS unnested_value);
-- remove 'All Subjects'
UPDATE xml2db.mapset SET keyword_theme = (SELECT array_agg(x) FROM unnest(keyword_theme) AS x WHERE x != 'All Subjects');
